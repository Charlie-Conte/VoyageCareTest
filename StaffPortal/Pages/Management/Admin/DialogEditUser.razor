@using System.ComponentModel.DataAnnotations
@using Microsoft.AspNetCore.Identity

@*
<!-- This is the popup to create or edit a user -->
<div class="modal" tabindex="-1" style="display: block" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Edit User</h3>
                <!-- Button to close the popup -->
                <button type="button" class="close"
                        @onclick="ClosePopup">
                    <span aria-hidden="true">X</span>
                </button>
            </div>
            <!-- Edit form for the current user -->
            <div class="modal-body">
                <!-- Only show Id if not a new user -->
                @if (objUser.Id != "")
                {
                    <p>@objUser.Id</p>
                }
                <!-- Only allow edit if a new user -->
                @if (objUser.Id != "")
                {
                    <p>@objUser.UserName</p>
                }
                else
                {
                    <input class="form-control" type="text"
                           placeholder="UserName"
                           @bind="objUser.UserName"/>
                }
                <input class="form-control" type="text"
                       placeholder="Email"
                       @bind="objUser.Email"/>
                <input class="form-control" type="password"
                       placeholder="Password"
                       @bind="objUser.PasswordHash"/>
                <select class="form-control"
                        @bind="@CurrentUserRole">
                    @foreach (var option in Options)
                    {
                        <option value="@option">
                            @option
                        </option>
                    }
                </select>
                <br/><br/>
                <!-- Button to save the user -->
                <button class="btn btn-primary"
                        @onclick="SaveUser">
                    Save
                </button>
                <!-- Only show delete button if not a new record -->
                @if (objUser.Id != "")
                {
                    <!-- Button to delete the forecast -->
                    <button class="btn btn-danger"
                            @onclick="DeleteUser">
                        Delete
                    </button>
                }
                <br/>
                <span style="color: red">@strError</span>
            </div>
        </div>
    </div>
</div>
*@

<MudDialog Class="">
    <DialogContent>
        <div class="d-flex flex-column py-1">
            <MudTextField Label="UserName" @bind-Value="User.UserName" For="@(() => User.UserName)"/>
            <MudTextField Label="Email" Class="mt-3" @bind-Value="User.Email" For="@(() => User.Email)"/>
            <MudTextField Label="PhoneNumber" Class="mt-3" @bind-Value="User.PhoneNumber" For="@(() => User.PhoneNumber)" />
        </div>
    </DialogContent>
    <DialogActions>
        <MudButton Color="Color.Primary" OnClick="Close">Ok</MudButton>
    </DialogActions>
</MudDialog>

@code {

    [CascadingParameter]
    MudDialogInstance MudDialog { get; set; } = null!;

    [Parameter]
    public IdentityUser User { get; set; } = new IdentityUser();

    void Close() => MudDialog.Close(DialogResult.Ok(true));




    void ToggleFullWidth()
    {
        MudDialog.Options.FullWidth = !(MudDialog.Options.FullWidth ?? true);
        MudDialog.SetOptions(MudDialog.Options);
    }



}